import{d as G,A as d,C as H,p as I,c as m,a,b as t,u as o,h as R,w as c,g as u,l as J,i as V,D as z,E as B,o as f,F as N,B as D,t as h,G as K,m as W,j as X}from"./app-eO1vBaLo.js";import{_ as Y}from"./index-C9qTIP7j.js";import{_ as j}from"./Input.vue_vue_type_script_setup_true_lang-D7uJclTA.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-D2u3hGM2.js";import{_ as x}from"./InputError.vue_vue_type_script_setup_true_lang-D7NyB6Ic.js";import{s as Z}from"./index-DeaJdLL4.js";import{q as F}from"./index-CMWG4mbA.js";import{d as ee}from"./index-Dhq0cQs_.js";import"./useForwardExpose-MhUvRWPS.js";const n=s=>({url:n.url(s),method:"post"});n.definition={methods:["post"],url:"/users/quick"};n.url=s=>n.definition.url+F(s);n.post=s=>({url:n.url(s),method:"post"});const U=s=>({action:n.url(s),method:"post"});U.post=s=>({action:n.url(s),method:"post"});n.form=U;const E={store:Object.assign(n,n)},r=s=>({url:r.url(s),method:"get"});r.definition={methods:["get","head"],url:"/users/search"};r.url=s=>r.definition.url+F(s);r.get=s=>({url:r.url(s),method:"get"});r.head=s=>({url:r.url(s),method:"head"});const $=s=>({action:r.url(s),method:"get"});$.get=s=>({action:r.url(s),method:"get"});$.head=s=>({action:r.url({[s?.mergeQuery?"mergeQuery":"query"]:{_method:"HEAD",...s?.query??s?.mergeQuery??{}}}),method:"get"});r.form=$;const te={search:Object.assign(r,r),quick:Object.assign(E,E)},se={class:"mx-auto max-w-6xl p-6"},le={class:"mb-6 flex items-center justify-between"},ae={class:"rounded-lg border bg-white/50 p-4 dark:bg-white/5"},oe={class:"flex gap-6"},re={class:"space-y-3 w-full"},ie={class:"flex items-center gap-3"},ne={key:0,class:"grid gap-3 sm:grid-cols-2"},ue={class:"space-y-3 w-full"},de={class:"flex items-center gap-3"},me={key:0,class:"grid gap-3"},ce={key:0,class:"max-h-48 overflow-auto rounded-md border"},fe=["onClick"],pe={class:"text-sm"},ge={class:"font-medium"},ve={class:"text-neutral-500"},he=["checked"],be={class:"rounded-lg border bg-white/50 p-4 dark:bg-white/5"},ke={class:"mb-3 flex items-center justify-between"},_e={class:"text-sm text-neutral-600 dark:text-neutral-300"},xe={class:"grid gap-2",style:{"grid-template-columns":"repeat(auto-fill, minmax(60px, 1fr))"}},ye=["onClick"],we={class:"mt-3 text-sm"},qe={class:"flex items-center justify-end gap-3"},De=G({__name:"Create",props:{taken:{default:()=>[]}},setup(s){const{taken:A}=s,p=d("quick"),k=d(null),y=d(""),w=d(""),q=d(""),_=d([]),O=d(!1);let C=new AbortController;H(q,async i=>{if(i.trim()===""){_.value=[];return}try{O.value=!0,C.abort(),C=new AbortController;const e=te.search.url({query:{q:i}}),v=await fetch(e,{signal:C.signal});if(!v.ok)return;_.value=await v.json()}catch{}finally{O.value=!1}});const P=Array.from({length:1e3},(i,e)=>String(e).padStart(3,"0")),g=d(new Set);function Q(i){A.includes(i)||(g.value.has(i)?g.value.delete(i):g.value.add(i))}const L=I(()=>(g.value.size*5).toFixed(2));function M(){const i=Array.from(g.value).map(e=>({number:e}));return p.value==="existing"&&k.value?{user_id:k.value,items:i}:{quick_user:{name:y.value,email:w.value},items:i}}return(i,e)=>(f(),m(N,null,[a(o(R),{title:"Crear Orden"}),t("div",se,[t("div",le,[e[6]||(e[6]=t("h1",{class:"text-2xl font-semibold"},"Nueva Orden",-1)),a(o(J),{href:o(ee)(),class:"rounded-md border px-3 py-2"},{default:c(()=>[...e[5]||(e[5]=[u("Menú principal",-1)])]),_:1},8,["href"])]),a(o(X),W(o(Z).form(),{transform:()=>M(),class:"grid gap-8"}),{default:c(({errors:v,processing:S,setData:Ce})=>[t("section",ae,[e[13]||(e[13]=t("h2",{class:"mb-3 text-lg font-medium"},"Cliente",-1)),t("div",oe,[t("div",re,[t("div",ie,[z(t("input",{id:"mode-quick",type:"radio",class:"size-4",name:"mode",value:"quick","onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l)},null,512),[[B,p.value]]),a(o(b),{for:"mode-quick"},{default:c(()=>[...e[7]||(e[7]=[u("Crear usuario rápido",-1)])]),_:1})]),p.value==="quick"?(f(),m("div",ne,[t("div",null,[a(o(b),{for:"quick-name"},{default:c(()=>[...e[8]||(e[8]=[u("Nombre",-1)])]),_:1}),a(o(j),{id:"quick-name",placeholder:"Nombre y Apellido",modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=l=>y.value=l)},null,8,["modelValue"]),a(x,{message:v["quick_user.name"]},null,8,["message"])]),t("div",null,[a(o(b),{for:"quick-email"},{default:c(()=>[...e[9]||(e[9]=[u("Email",-1)])]),_:1}),a(o(j),{id:"quick-email",type:"email",placeholder:"cliente@example.com",modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=l=>w.value=l)},null,8,["modelValue"]),a(x,{message:v["quick_user.email"]},null,8,["message"])]),e[10]||(e[10]=t("p",{class:"col-span-2 text-xs text-neutral-500"},"La contraseña inicial se establece en el backend.",-1))])):V("",!0)]),t("div",ue,[t("div",de,[z(t("input",{id:"mode-existing",type:"radio",class:"size-4",name:"mode",value:"existing","onUpdate:modelValue":e[3]||(e[3]=l=>p.value=l)},null,512),[[B,p.value]]),a(o(b),{for:"mode-existing"},{default:c(()=>[...e[11]||(e[11]=[u("Seleccionar usuario existente",-1)])]),_:1})]),p.value==="existing"?(f(),m("div",me,[t("div",null,[a(o(b),{for:"search"},{default:c(()=>[...e[12]||(e[12]=[u("Buscar",-1)])]),_:1}),a(o(j),{id:"search",placeholder:"Nombre o email",modelValue:q.value,"onUpdate:modelValue":e[4]||(e[4]=l=>q.value=l)},null,8,["modelValue"])]),_.value.length?(f(),m("div",ce,[t("ul",null,[(f(!0),m(N,null,D(_.value,l=>(f(),m("li",{key:l.id,onClick:T=>k.value=l.id,class:"flex cursor-pointer items-center justify-between px-3 py-2 hover:bg-black/5 dark:hover:bg-white/10"},[t("div",pe,[t("div",ge,h(l.name),1),t("div",ve,h(l.email),1)]),t("input",{type:"radio",checked:k.value===l.id},null,8,he)],8,fe))),128))])])):V("",!0),a(x,{message:v.user_id},null,8,["message"])])):V("",!0)])])]),t("section",be,[t("div",ke,[e[14]||(e[14]=t("h2",{class:"text-lg font-medium"},"Números (000–999)",-1)),t("div",_e,"Seleccionados: "+h(g.value.size),1)]),t("div",xe,[(f(!0),m(N,null,D(o(P),l=>(f(),m("button",{key:l,type:"button",class:K(["rounded-md px-2 py-2 text-sm font-semibold ring-1 transition",[g.value.has(l)?"bg-teal-600 text-white ring-teal-700":"bg-white dark:bg-white/10 text-teal-900 dark:text-white ring-black/10 dark:ring-white/10 hover:bg-black/5 dark:hover:bg-white/15",A.includes(l)?"is-taken":""]]),onClick:T=>Q(l)},h(l),11,ye))),128))]),a(x,{message:v.items},null,8,["message"]),t("p",we,[e[15]||(e[15]=u("Precio por número: ",-1)),e[16]||(e[16]=t("strong",null,"$5.00",-1)),e[17]||(e[17]=u(" — Total: ",-1)),t("strong",null,"$"+h(L.value),1)])]),t("div",qe,[a(o(Y),{type:"submit",disabled:S},{default:c(()=>[u(h(S?"Creando...":"Crear Orden"),1)]),_:2},1032,["disabled"])])]),_:1},16,["transform"])])],64))}});export{De as default};
