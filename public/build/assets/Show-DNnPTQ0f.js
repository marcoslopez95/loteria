import{d as F,p as V,A as p,C as M,c as o,a,b as t,u as s,h as B,t as r,G as D,w as i,g as m,l as P,F as v,B as U,i as j,D as E,o as u,I as T,m as R,j as I}from"./app-DywYQFEO.js";import{_ as O}from"./index-BcuwYTpR.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-CqO7JhGi.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-DJR_5Y_h.js";import{_ as g}from"./InputError.vue_vue_type_script_setup_true_lang-B2usDqnw.js";import{e as z,i as G,p as L}from"./index-DeaJdLL4.js";import{d as q}from"./index-Dhq0cQs_.js";import"./useForwardExpose-BBVPpTF_.js";import"./index-CMWG4mbA.js";const H={class:"mx-auto max-w-6xl p-6 space-y-6"},J={class:"flex items-center justify-between"},K={class:"text-2xl font-semibold"},Q={class:"text-sm text-neutral-600 dark:text-neutral-300"},W={class:"flex items-center gap-2"},X={class:"rounded-lg border bg-white/50 p-4 dark:bg-white/5"},Y={class:"grid gap-2",style:{"grid-template-columns":"repeat(auto-fill, minmax(60px, 1fr))"}},Z={class:"rounded-lg border bg-white/50 p-4 dark:bg-white/5"},ee={key:0,class:"mb-4 overflow-hidden rounded-md border"},te={class:"min-w-full divide-y divide-black/10 dark:divide-white/10"},ae={class:"px-4 py-2 text-sm font-mono"},se={class:"px-4 py-2 text-right text-sm"},de={class:"px-4 py-2 text-right text-sm"},le={class:"px-4 py-2 text-sm"},re={class:"px-4 py-2 text-sm"},ne={key:1,class:"rounded-md border p-4"},oe=["value"],ie={class:"col-span-5"},ue={class:"col-span-5 flex justify-end"},me={key:2,class:"rounded-md border border-yellow-300/60 bg-yellow-100/60 p-3 text-sm text-yellow-900 dark:border-yellow-600/50 dark:bg-yellow-300/10 dark:text-yellow-200"},we=F({__name:"Show",props:{order:{},paidAmountUsd:{},currencies:{}},setup(l){const y=l,C=V(()=>y.order.status==="PorPagar"),w=p(""),x=p(null),f=p("1"),k=p(""),_=p(""),N=V(()=>y.currencies.find(c=>c.code==="USD"));V(()=>y.currencies.find(c=>c.code==="VES")),N.value&&(x.value=N.value.id,f.value="1"),M(x,c=>{const e=y.currencies.find(d=>d.id===c);e&&(e.code==="USD"?f.value="1":e.code==="VES"&&(f.value="221"))});function $(){return{amount:w.value,currency_id:x.value,exchange_rate:f.value,reference:k.value,paid_at:_.value||void 0}}function A(c){switch(c){case"Pagada":return"bg-green-600 text-white";case"Cancelada":return"bg-red-600 text-white";default:return"bg-yellow-500 text-black"}}return(c,e)=>(u(),o(v,null,[a(s(B),{title:`Orden #${l.order.id}`},null,8,["title"]),t("div",H,[t("div",J,[t("div",null,[t("h1",K,"Orden #"+r(l.order.id),1),t("p",Q,"Cliente: "+r(l.order.user?.name??"—")+" — Total: $"+r(l.order.total)+" — Pagado: $"+r(l.paidAmountUsd),1)]),t("div",W,[t("span",{class:D(["rounded px-2 py-0.5 text-xs font-semibold",A(l.order.status)])},r(l.order.status),3),a(s(P),{href:s(q)(),class:"rounded-md border px-3 py-2"},{default:i(()=>[...e[5]||(e[5]=[m("Menú principal",-1)])]),_:1},8,["href"]),a(s(P),{href:s(z)([l.order.id]).url,class:"rounded-md bg-black/90 px-3 py-2 text-white hover:bg-black"},{default:i(()=>[...e[6]||(e[6]=[m("Editar",-1)])]),_:1},8,["href"]),a(s(P),{href:s(G)().url,class:"rounded-md border px-3 py-2"},{default:i(()=>[...e[7]||(e[7]=[m("Volver a órdenes",-1)])]),_:1},8,["href"])])]),t("section",X,[e[8]||(e[8]=t("h2",{class:"mb-2 text-lg font-medium"},"Números",-1)),t("div",Y,[(u(!0),o(v,null,U(l.order.items,d=>(u(),o("div",{key:d.id,class:"rounded-md bg-white px-2 py-2 text-center font-semibold ring-1 ring-black/10 dark:bg-white/10 dark:ring-white/10"},r(d.number),1))),128))])]),t("section",Z,[e[15]||(e[15]=t("div",{class:"mb-3 flex items-center justify-between"},[t("h2",{class:"text-lg font-medium"},"Pagos"),t("div",{class:"text-sm text-neutral-600 dark:text-neutral-300"},"Se permiten pagos sólo cuando la orden está PorPagar")],-1)),l.order.payments.length?(u(),o("div",ee,[t("table",te,[e[9]||(e[9]=t("thead",{class:"bg-black/5 dark:bg-white/10"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-sm"},"Referencia"),t("th",{class:"px-4 py-2 text-right text-sm"},"Monto"),t("th",{class:"px-4 py-2 text-right text-sm"},"Tasa"),t("th",{class:"px-4 py-2 text-left text-sm"},"Moneda"),t("th",{class:"px-4 py-2 text-left text-sm"},"Fecha")])],-1)),t("tbody",null,[(u(!0),o(v,null,U(l.order.payments,d=>(u(),o("tr",{key:d.id,class:"odd:bg-white even:bg-black/2.5 dark:odd:bg-white/5"},[t("td",ae,r(d.reference),1),t("td",se,r(Number(d.amount).toFixed(2)),1),t("td",de,r(Number(d.exchange_rate).toFixed(2)),1),t("td",le,r(d.currency?.code??""),1),t("td",re,r(d.paid_at?.substring(0,10)??""),1)]))),128))])])])):j("",!0),C.value?(u(),o("div",ne,[a(s(I),R(s(L).store.form([l.order.id]),{transform:()=>$(),class:"grid gap-4 sm:grid-cols-5"}),{default:i(({errors:d,processing:S})=>[t("div",null,[a(s(b),{for:"amount"},{default:i(()=>[...e[10]||(e[10]=[m("Monto",-1)])]),_:1}),a(s(h),{id:"amount",name:"amount",type:"number",step:"0.01",min:"0.01",modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=n=>w.value=n)},null,8,["modelValue"]),a(g,{message:d.amount},null,8,["message"])]),t("div",null,[a(s(b),{for:"currency"},{default:i(()=>[...e[11]||(e[11]=[m("Moneda",-1)])]),_:1}),E(t("select",{id:"currency",name:"currency_id","onUpdate:modelValue":e[1]||(e[1]=n=>x.value=n),class:"w-full rounded-md border bg-white px-3 py-2 text-sm dark:bg-white/10 dark:text-white dark:border-white/10"},[(u(!0),o(v,null,U(l.currencies,n=>(u(),o("option",{value:n.id,key:n.id},r(n.code)+" ("+r(n.symbol)+")",9,oe))),128))],512),[[T,x.value,void 0,{number:!0}]]),a(g,{message:d.currency_id},null,8,["message"])]),t("div",null,[a(s(b),{for:"rate"},{default:i(()=>[...e[12]||(e[12]=[m("Tasa",-1)])]),_:1}),a(s(h),{id:"rate",name:"exchange_rate",type:"number",step:"0.00000001",min:"0.00000001",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=n=>f.value=n)},null,8,["modelValue"]),a(g,{message:d.exchange_rate},null,8,["message"])]),t("div",null,[a(s(b),{for:"reference"},{default:i(()=>[...e[13]||(e[13]=[m("Referencia",-1)])]),_:1}),a(s(h),{id:"reference",name:"reference",modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=n=>k.value=n)},null,8,["modelValue"]),a(g,{message:d.reference},null,8,["message"])]),t("div",null,[a(s(b),{for:"paid_at"},{default:i(()=>[...e[14]||(e[14]=[m("Fecha",-1)])]),_:1}),a(s(h),{id:"paid_at",name:"paid_at",type:"date",modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=n=>_.value=n)},null,8,["modelValue"]),a(g,{message:d.paid_at},null,8,["message"])]),t("div",ie,[a(g,{message:d.payment},null,8,["message"])]),t("div",ue,[a(s(O),{type:"submit",disabled:S},{default:i(()=>[m(r(S?"Agregando...":"Agregar pago"),1)]),_:2},1032,["disabled"])])]),_:1},16,["transform"])])):(u(),o("div",me," No se pueden agregar pagos a una orden "+r(l.order.status)+". ",1))])])],64))}});export{we as default};
