import{g as y,c as N}from"./useForwardPropsEmits-BlJI9C0l.js";import{a as C,u as D}from"./VisuallyHidden-DlPWZZ6B.js";import{S as h,P as U}from"./Primitive-mBBXJQJs.js";import{B as S,a3 as k,a4 as G,p as R,d as T,S as L,a5 as $,a6 as _,C as V,R as K,f as j,o as z,w as M,a as Y,u as b,v as H}from"./app-BQykWeyp.js";import{b as J}from"./useForwardExpose-K1HLZKpI.js";const O="data-reka-collection-item";function Q(t={}){const{key:r="",isProvider:l=!1}=t,e=`${r}CollectionProvider`;let o;if(l){const a=S(new Map);o={collectionRef:S(),itemMap:a},k(e,o)}else o=G(e);const E=(a=!1)=>{const n=o.collectionRef.value;if(!n)return[];const s=Array.from(n.querySelectorAll(`[${O}]`)),f=Array.from(o.itemMap.value.values()).sort((d,p)=>s.indexOf(d.ref)-s.indexOf(p.ref));return a?f:f.filter(d=>d.ref.dataset.disabled!=="")},A=T({name:"CollectionSlot",setup(a,{slots:n}){const{primitiveElement:s,currentElement:c}=C();return V(c,()=>{o.collectionRef.value=c.value}),()=>_(h,{ref:s},n)}}),F=T({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:n,attrs:s}){const{primitiveElement:c,currentElement:f}=C();return L(d=>{if(f.value){const p=$(f.value);o.itemMap.value.set(p,{ref:f.value,value:a.value}),d(()=>o.itemMap.value.delete(p))}}),()=>_(h,{...s,[O]:"",ref:c},n)}}),I=R(()=>Array.from(o.itemMap.value.values())),m=R(()=>o.itemMap.value.size);return{getItems:E,reactiveItems:I,itemMapSize:m,CollectionSlot:A,CollectionItem:F}}const W="rovingFocusGroup.onEntryFocus",X={bubbles:!1,cancelable:!0},Z={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ee(t,r){return r!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function ue(t,r,l){const e=ee(t.key,l);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(e))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(e)))return Z[e]}function te(t,r=!1){const l=y();for(const e of t)if(e===l||(e.focus({preventScroll:r}),y()!==l))return}function ce(t,r){return t.map((l,e)=>t[(r+e)%t.length])}const[fe,oe]=N("RovingFocusGroup");var re=T({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(t,{expose:r,emit:l}){const e=t,o=l,{loop:E,orientation:A,dir:F}=K(e),I=D(F),m=J(e,"currentTabStopId",o,{defaultValue:e.defaultCurrentTabStopId,passive:e.currentTabStopId===void 0}),a=S(!1),n=S(!1),s=S(0),{getItems:c,CollectionSlot:f}=Q({isProvider:!0});function d(i){const v=!n.value;if(i.currentTarget&&i.target===i.currentTarget&&v&&!a.value){const g=new CustomEvent(W,X);if(i.currentTarget.dispatchEvent(g),o("entryFocus",g),!g.defaultPrevented){const w=c().map(u=>u.ref).filter(u=>u.dataset.disabled!==""),P=w.find(u=>u.getAttribute("data-active")===""),x=w.find(u=>u.getAttribute("data-highlighted")===""),q=w.find(u=>u.id===m.value),B=[P,x,q,...w].filter(Boolean);te(B,e.preventScrollOnEntryFocus)}}n.value=!1}function p(){setTimeout(()=>{n.value=!1},1)}return r({getItems:c}),oe({loop:E,dir:I,orientation:A,currentTabStopId:m,onItemFocus:i=>{m.value=i},onItemShiftTab:()=>{a.value=!0},onFocusableItemAdd:()=>{s.value++},onFocusableItemRemove:()=>{s.value--}}),(i,v)=>(z(),j(b(f),null,{default:M(()=>[Y(b(U),{tabindex:a.value||s.value===0?-1:0,"data-orientation":b(A),as:i.as,"as-child":i.asChild,dir:b(I),style:{outline:"none"},onMousedown:v[0]||(v[0]=g=>n.value=!0),onMouseup:p,onFocus:d,onBlur:v[1]||(v[1]=g=>a.value=!1)},{default:M(()=>[H(i.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),de=re;export{de as R,te as f,ue as g,fe as i,Q as u,ce as w};
